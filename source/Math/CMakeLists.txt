cmake_minimum_required(VERSION 3.16) # 3.16 is needed for target_precompile_headers

set(MATH_TARGET ${PROJECT_NAME}_Math)
set(SOURCE_DIR .)

# This .cmake includes and defines the ${PROJECT_NAME}_SOURCES variable !
# It is generated by the generate_cmake_sources script.
include(CMake/CMakeLists_sources.cmake)

# So far, Math is a header-only library, so make it an Interface. Maybe that will change someday.
if(${PROJECT_NAME}_BUILD_SHARED_LIB)
add_library(${MATH_TARGET} SHARED ${${MATH_TARGET}_SOURCES})
else()
add_library(${MATH_TARGET} STATIC ${${MATH_TARGET}_SOURCES} )
endif()

# Create the source groups for source tree with root at CMAKE_CURRENT_SOURCE_DIR
# to recreate the folder tree with filters within Visual Studio for example.
source_group(TREE ${CMAKE_CURRENT_SOURCE_DIR} FILES ${${MATH_TARGET}_SOURCES})

target_include_directories(${MATH_TARGET} PUBLIC ${PROJECT_SOURCE_DIR}/source)

target_link_libraries(${MATH_TARGET}
	PUBLIC ${PROJECT_NAME}_Core
	PUBLIC ${PROJECT_NAME})  # Linking with project's Interface Library allows us to reuse PCH's.

# If using GLM, integrate it in the build (it's a header only library)
if(${PROJECT_NAME}_USE_GLM)
	set(GLM_DIR ${PROJECT_SOURCE_DIR}/vendor/glm)

	target_include_directories(${MATH_TARGET} PUBLIC "${GLM_DIR}")

endif()

# Kinda "trick" to make Visual Studio add a project that doesn't compile but lets us edit code in the editor.
# if(MSVC)
    # add_custom_target(${MATH_TARGET}.headers SOURCES ${${MATH_TARGET}_SOURCES})
	# target_link_libraries(${MATH_TARGET}.headers
	# PUBLIC ${PROJECT_NAME}_Core
	# PUBLIC ${PROJECT_NAME})  # Linking with project's Interface Library allows us to reuse PCH's.
# endif()
